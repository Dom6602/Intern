<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- SITE TITTLE -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Classimax</title>

    <!-- FAVICON -->
    <link href="img/favicon.png" rel="shortcut icon" />
    <!-- PLUGINS CSS STYLE -->
    <!-- <link href="plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet"> -->
    <!-- Bootstrap -->
    <link rel="stylesheet" href="plugins/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="plugins/bootstrap/css/bootstrap-slider.css" />
    <!-- Font Awesome -->
    <link
      href="plugins/font-awesome/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <!-- Owl Carousel -->
    <link href="plugins/slick-carousel/slick/slick.css" rel="stylesheet" />
    <link
      href="plugins/slick-carousel/slick/slick-theme.css"
      rel="stylesheet"
    />
    <!-- Fancy Box -->
    <link href="plugins/fancybox/jquery.fancybox.pack.css" rel="stylesheet" />
    <link
      href="plugins/jquery-nice-select/css/nice-select.css"
      rel="stylesheet"
    />
    <!-- CUSTOM CSS -->
    <link href="css/style.css" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body class="body-wrapper">
    <section>
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <nav class="navbar navbar-expand-lg navbar-light navigation">
              <a class="navbar-brand" href="index.html">
                <img src="images/logo.png" alt="" />
              </a>
              <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent"
                aria-expanded="false"
                aria-label="Toggle navigation"
              >
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto main-nav">
                  <li class="nav-item active">
                    <a class="nav-link" href="index.html">Home</a>
                  </li>
                  <li class="nav-item dropdown dropdown-slide">
                    <a
                      class="nav-link dropdown-toggle"
                      data-toggle="dropdown"
                      href=""
                      >Dashboard<span><i class="fa fa-angle-down"></i></span>
                    </a>

                    <!-- Dropdown list -->
                    <div class="dropdown-menu">
                      <a class="dropdown-item" href="dashboard-my-ads.html"
                        >Dashboard My Ads</a
                      >
                      <a
                        class="dropdown-item"
                        href="dashboard-favourite-ads.html"
                        >Dashboard Favourite Ads</a
                      >
                      <a
                        class="dropdown-item"
                        href="dashboard-archived-ads.html"
                        >Dashboard Archived Ads</a
                      >
                      <a class="dropdown-item" href="dashboard-pending-ads.html"
                        >Dashboard Pending Ads</a
                      >
                    </div>
                  </li>
                  <li class="nav-item dropdown dropdown-slide">
                    <a class="nav-link dropdown-toggle" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Categories <span><i class="fa fa-angle-down"></i></span>
                    </a>
                    <!-- Dropdown list -->
                    <div class="dropdown-menu">
                      <a class="dropdown-item" href="#">Electronics</a>
                      <a class="dropdown-item" href="#">Restaurants</a>
                      <a class="dropdown-item" href="#">Real Estate</a>
                    </div>
                  </li>
                </ul>
                <ul class="navbar-nav ml-auto mt-10">
                  <li class="nav-item">
                    <a class="nav-link login-button" href="login.html">Login</a>
                  </li>
                  <li class="nav-item">
                    <a
                      class="nav-link text-white add-button"
                      href="ad-listing.html"
                      ><i class="fa fa-plus-circle"></i> Add Listing</a
                    >
                  </li>
                </ul>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </section>
    <!--==================================
=            User Profile            =
===================================-->

    <section class="user-profile section">
      <div class="container">
        <div class="row">
          <div class="col-md-10 offset-md-1 col-lg-3 offset-lg-0">
            <div class="sidebar">
              <!-- User Widget -->
              <div class="widget user">
                <!-- User Image -->
                <div class="image d-flex justify-content-center">
                  <img src="" alt="" class="" id="get-image"/>
                </div>
                <!-- User Name -->
                <h5 class="text-center" id="firstLast"></h5>
              </div>
              <!-- Dashboard Links -->
              <div class="widget dashboard-links">
                <ul>
                  <li>
                    <a class="my-1 d-inline-block" href="">Savings Dashboard</a>
                  </li>
                  <li>
                    <a class="my-1 d-inline-block" href=""
                      >Saved Offer <span>(5)</span></a
                    >
                  </li>
                  <li>
                    <a class="my-1 d-inline-block" href=""
                      >Favourite Stores <span>(3)</span></a
                    >
                  </li>
                  <li>
                    <a class="my-1 d-inline-block" href="">Recommended</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-10 offset-md-1 col-lg-9 offset-lg-0">
            <!-- Edit Profile Welcome Text -->
            <div class="widget welcome-message">
              <h2>Edit profile</h2>
              <p>
                Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
                eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
                enim ad minim veniam, quis nostrud exercitation
              </p>
            </div>
            <!-- Edit Personal Info -->
            <div class="row">
              <div class="col-lg-6 col-md-6">
                <div class="widget personal-info">
                  <h3 class="widget-header user">Edit Personal Information</h3>
                  <form action="#">
                    <!-- First Name -->
                    <div class="form-group">
                      <label for="first-name">First Name</label>
                      <input type="text" class="form-control" id="first-name" />
                    </div>
                    <!-- Last Name -->
                    <div class="form-group">
                      <label for="last-name">Last Name</label>
                      <input type="text" class="form-control" id="last-name" />
                    </div>
                    <!-- File chooser -->
                    <div
                      class="form-group choose-file d-inline-flex"
                      enctype="multipart/form-data"
                    >
                      <i class="fa fa-user text-center px-3"></i>
                      <input
                        type="file"
                        class="form-control-file mt-2 pt-1"
                        id="input-file"
                      />
                    </div>
                    <!-- Comunity Name -->
                    <div class="form-group">
                      <label for="comunity-name">Comunity Name</label>
                      <input
                        type="text"
                        class="form-control"
                        id="comunity-name"
                      />
                    </div>
                    <!-- Checkbox -->
                    <div class="form-check">
                      <label class="form-check-label" for="hide-profile">
                        <input
                          class="form-check-input mt-1"
                          type="checkbox"
                          value=""
                          id="hide-profile"
                        />
                        Hide Profile from Public/Comunity
                      </label>
                    </div>
                    <!-- Zip Code -->
                    <div class="form-group">
                      <label for="zip-code">Zip Code</label>
                      <input type="text" class="form-control" id="zip-code" />
                    </div>
                    <!-- Submit button -->
                    <button class="btn btn-transparent" onclick="savemyChanges()">
                      Save My Changes
                    </button>
                  </form>
                </div>
              </div>
              <div class="col-lg-6 col-md-6">
                <!-- Change Password -->
                <div class="widget change-password">
                  <h3 class="widget-header user">Edit Password</h3>
                  <form action="#">
                    <!-- Current Password -->
                    <div class="form-group">
                      <label for="current-password">Current Password</label>
                      <input
                        type="password"
                        class="form-control"
                        id="current-password"
                      />
                    </div>
                    <!-- New Password -->
                    <div class="form-group">
                      <label for="new-password">New Password</label>
                      <input
                        type="password"
                        class="form-control"
                        id="new-password"
                      />
                    </div>
                    <!-- Confirm New Password -->
                    <div class="form-group">
                      <label for="confirm-password">Confirm New Password</label>
                      <input
                        type="password"
                        class="form-control"
                        id="confirm-password"
                      />
                    </div>
                    <!-- Submit Button -->
                    <button
                      class="btn btn-transparent"
                      onclick="changePassword()"
                    >
                      Change Password
                    </button>
                  </form>
                </div>
              </div>
              <div class="col-lg-6 col-md-6">
                <!-- Change Email Address -->
                <div class="widget change-email mb-0">
                  <h3 class="widget-header user">Edit Email Address</h3>
                  <form action="#">
                    <!-- Current Password -->
                    <div class="form-group">
                      <label for="current-email">Current Email</label>
                      <input
                        type="email"
                        class="form-control"
                        id="current-email"
                      />
                    </div>
                    <!-- New email -->
                    <div class="form-group">
                      <label for="new-email">New email</label>
                      <input type="email" class="form-control" id="new-email" />
                    </div>
                    <!-- Submit Button -->
                    <button class="btn btn-transparent" onclick="changeEmail()">
                      Change email
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!--============================
=            Footer            =
=============================-->

    <footer class="footer section section-sm">
      <!-- Container Start -->
      <div class="container">
        <div class="row">
          <div class="col-lg-3 col-md-7 offset-md-1 offset-lg-0">
            <!-- About -->
            <div class="block about">
              <!-- footer logo -->
              <img src="images/logo-footer.png" alt="" />
              <!-- description -->
              <p class="alt-color">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
                eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
                enim ad minim veniam, quis nostrud exercitation ullamco laboris
                nisi ut aliquip ex ea commodo consequat.
              </p>
            </div>
          </div>
          <!-- Link list -->
          <div class="col-lg-2 offset-lg-1 col-md-3">
            <div class="block">
              <h4>Site Pages</h4>
              <ul>
                <li><a href="#">Boston</a></li>
                <li><a href="#">How It works</a></li>
                <li><a href="#">Deals & Coupons</a></li>
                <li><a href="#">Articls & Tips</a></li>
                <li><a href="terms-condition.html">Terms & Conditions</a></li>
              </ul>
            </div>
          </div>
          <!-- Link list -->
          <div class="col-lg-2 col-md-3 offset-md-1 offset-lg-0">
            <div class="block">
              <h4>Admin Pages</h4>
              <ul>
                <li><a href="category.html">Category</a></li>
                <li><a href="single.html">Single Page</a></li>
                <li><a href="store.html">Store Single</a></li>
                <li><a href="single-blog.html">Single Post</a></li>
                <li><a href="blog.html">Blog</a></li>
              </ul>
            </div>
          </div>
          <!-- Promotion -->
          <div class="col-lg-4 col-md-7">
            <!-- App promotion -->
            <div class="block-2 app-promotion">
              <div class="mobile d-flex">
                <a href="">
                  <!-- Icon -->
                  <img src="images/footer/phone-icon.png" alt="mobile-icon" />
                </a>
                <p>Get the Dealsy Mobile App and Save more</p>
              </div>
              <div class="download-btn d-flex my-3">
                <a href="#"
                  ><img
                    src="images/apps/google-play-store.png"
                    class="img-fluid"
                    alt=""
                /></a>
                <a href="#" class="ml-3"
                  ><img
                    src="images/apps/apple-app-store.png"
                    class="img-fluid"
                    alt=""
                /></a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Container End -->
    </footer>
    <!-- Footer Bottom -->
    <footer class="footer-bottom">
      <!-- Container Start -->
      <div class="container">
        <div class="row">
          <div class="col-sm-6 col-12">
            <!-- Copyright -->
            <div class="copyright">
              <p>
                Copyright Â©
                <script>
                  var CurrentYear = new Date().getFullYear();
                  document.write(CurrentYear);
                </script>
                . All Rights Reserved, theme by
                <a
                  class="text-primary"
                  href="https://themefisher.com"
                  target="_blank"
                  >themefisher.com</a
                >
              </p>
            </div>
          </div>
          <div class="col-sm-6 col-12">
            <!-- Social Icons -->
            <ul class="social-media-icons text-right">
              <li>
                <a
                  class="fa fa-facebook"
                  href="https://www.facebook.com/themefisher"
                  target="_blank"
                ></a>
              </li>
              <li>
                <a
                  class="fa fa-twitter"
                  href="https://www.twitter.com/themefisher"
                  target="_blank"
                ></a>
              </li>
              <li>
                <a
                  class="fa fa-pinterest-p"
                  href="https://www.pinterest.com/themefisher"
                  target="_blank"
                ></a>
              </li>
              <li><a class="fa fa-vimeo" href=""></a></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- Container End -->
      <!-- To Top -->
      <div class="top-to">
        <a id="top" class="" href="#"><i class="fa fa-angle-up"></i></a>
      </div>
    </footer>

    <!-- JAVASCRIPTS -->
    <script src="plugins/jQuery/jquery.min.js"></script>
    <script src="plugins/bootstrap/js/popper.min.js"></script>
    <script src="plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="plugins/bootstrap/js/bootstrap-slider.js"></script>
    <!-- tether js -->
    <script src="plugins/tether/js/tether.min.js"></script>
    <script src="plugins/raty/jquery.raty-fa.js"></script>
    <script src="plugins/slick-carousel/slick/slick.min.js"></script>
    <script src="plugins/jquery-nice-select/js/jquery.nice-select.min.js"></script>
    <script src="plugins/fancybox/jquery.fancybox.pack.js"></script>
    <script src="plugins/smoothscroll/SmoothScroll.min.js"></script>
    <!-- google map -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcABaamniA6OL5YvYSpB3pFMNrXwXnLwU&libraries=places"></script>
    <script src="plugins/google-map/gmap.js"></script>
    <script src="js/script.js"></script>
  </body>

  <script>
    const accessToken = localStorage.getItem("token");
    console.log("accessToken", accessToken);
    // console.log(accessToken == null);

    if (accessToken == null || accessToken == "") {
      
      window.location.href = "http://127.0.0.1:5500/themes/classimax-free/login.html"
    }
    else {

      fetch("http://localhost:3000/roleCheck", {
            method: "GET",
            headers: {
              "x-auth-token": accessToken,
            }
            })
            .then((response) => response.json())  
            .then((data) => {
              console.log("Response from server:", data.message);
              console.log("Response from server:", data.Role);

              console.log("Response from server:", data.userEmail);

              // if((data.Role  !== "Authorized") && (data.Role  !== "Not Authorized")) {
              //   window.location.href = "http://127.0.0.1:5500/themes/classimax-free/login.html"
              // }
              // else {

                const authorizedNot = data.Role
                
                  data = {
                    currentEmail: data.userEmail
                  };

                  fetch("http://localhost:3000/getFullDetails", {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify(data),
                  })
                  .then((response) => response.json())
                  .then((data) => {
                    console.log("Response from server:", data.message);
                    console.log("Response from server:", data.userDatas);

                    // console.log(authorizedNot);

                    if(data.Role  === "invalid") {
                      window.location.href = "http://127.0.0.1:5500/themes/classimax-free/login.html"
                    }
                    else if(authorizedNot === "Authorized") {

                      const loginNavItem = document.querySelector(".navbar-nav.ml-auto.mt-10 .nav-item");
                      if (loginNavItem) {
                        loginNavItem.style.display = "none";
                      }

                    }
                    else {
                      const firstNavItem = document.querySelector(".nav-item.dropdown.dropdown-slide");
                      if (firstNavItem) {
                      firstNavItem.style.display = "none";
                      }

                      const loginNavItem = document.querySelector(".navbar-nav.ml-auto.mt-10 .nav-item");
                      if (loginNavItem) {
                        loginNavItem.style.display = "none";
                      }

                      const addListingNavItem = document.querySelector(".navbar-nav.ml-auto.mt-10 .nav-item .nav-link.text-white.add-button");
                      if (addListingNavItem) {
                        addListingNavItem.style.display = "none";
                      }
                    }

                      


                    currentEmail = document.getElementById("current-email");
                    currentEmail.value = data.userDatas.username;

                    firstLast = document.getElementById("firstLast");
                    if (
                      data.userDatas.firstname == undefined &&
                      data.userDatas.lastname == undefined
                    )
                      firstLast.value = "";
                    else firstLast.textContent = data.userDatas.firstname + ' ' + data.userDatas.lastname;

                    firstName = document.getElementById("first-name");
                    if (data.userDatas.firstname == undefined) firstName.value = "";
                    else firstName.value = data.userDatas.firstname;

                    lastName = document.getElementById("last-name");
                    if (data.userDatas.lastname == undefined) lastName.value = "";
                    else lastName.value = data.userDatas.lastname;

                    comunityName = document.getElementById("comunity-name");
                    if (data.userDatas.comunityname == undefined)
                      comunityName.value = "";
                    else comunityName.value = data.userDatas.comunityname;

                    zipCode = document.getElementById("zip-code");
                    if (data.userDatas.firstname == undefined) zipCode.value = "";
                    else zipCode.value = data.userDatas.zipcode;

                    const imageElement = document.getElementById('get-image');
                    if (data.userDatas.profileimage == undefined){}
                    else 
                      imageElement.src = `data:image/jpeg;base64,${data.userDatas.profileimage}`;
                    

                  })
                  .catch((error) => {
                    console.error("Error sending data to server:", error);
                  });

              // }
            })
            .catch((error) => {
              console.error("Error sending data to server:", error);
            });

          }
          function changeEmail() {
            currentEmail = document.getElementById("current-email").value;
            newEmail = document.getElementById("new-email").value;

            if (newEmail == "") {
              var notification = document.createElement("div");
              notification.textContent = "Please Enter New Email";
              notification.style.backgroundColor = "#F05F5E";
              notification.style.color = "white";
              notification.style.position = "fixed";
              notification.style.top = "0";
              notification.style.right = "0";
              notification.style.padding = "10px";
              notification.style.marginTop = "20px";
              notification.style.marginRight = "30px";
              notification.style.borderRadius = "5px";
              document.body.appendChild(notification);

              setTimeout(() => {
                document.body.removeChild(notification);
              }, 2000);
            } else if (newEmail == currentEmail) {
              var notification = document.createElement("div");
              notification.textContent = "Please Enter Different Email";
              notification.style.backgroundColor = "#F05F5E";
              notification.style.color = "white";
              notification.style.position = "fixed";
              notification.style.top = "0";
              notification.style.right = "0";
              notification.style.padding = "10px";
              notification.style.marginTop = "20px";
              notification.style.marginRight = "30px";
              notification.style.borderRadius = "5px";
              document.body.appendChild(notification);

              setTimeout(() => {
                document.body.removeChild(notification);
              }, 2000);
            } else {
              data = {
                currentEmail: currentEmail,
                updateEmail: newEmail,
              };

              fetch("http://localhost:3000/updateEmail", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
              })
                .then((response) => response.json())
                .then((data) => {
                  console.log("Response from server:", data.message);
                  localStorage.removeItem("token");

                  var notification = document.createElement("div");
                  notification.textContent = "Email Updated Successfully";
                  notification.style.backgroundColor = "#47C8A3";
                  notification.style.color = "white";
                  notification.style.position = "fixed";
                  notification.style.top = "0";
                  notification.style.right = "0";
                  notification.style.padding = "10px";
                  notification.style.marginTop = "20px";
                  notification.style.marginRight = "30px";
                  notification.style.borderRadius = "5px";
                  document.body.appendChild(notification);

                  setTimeout(() => {
                    document.body.removeChild(notification);
                    window.location.href =
                      "http://127.0.0.1:5500/themes/classimax-free/login.html";
                  }, 2000);
                })
                .catch((error) => {
                  console.error("Error sending data to server:", error);
                });
            }

            event.preventDefault();
          }

          function changePassword() {
            currentEmail = document.getElementById("current-email").value;
            currentPassword = document.getElementById("current-password").value;
            newPassword = document.getElementById("new-password").value;
            confirmPassword = document.getElementById("confirm-password").value;

            if (currentPassword == "") {
              var notification = document.createElement("div");
              notification.textContent = "Please Enter currentPassword";
              notification.style.backgroundColor = "#F05F5E";
              notification.style.color = "white";
              notification.style.position = "fixed";
              notification.style.top = "0";
              notification.style.right = "0";
              notification.style.padding = "10px";
              notification.style.marginTop = "20px";
              notification.style.marginRight = "30px";
              notification.style.borderRadius = "5px";
              document.body.appendChild(notification);

              setTimeout(() => {
                document.body.removeChild(notification);
              }, 2000);
            } else if (
              newPassword == "" ||
              confirmPassword == "" ||
              newPassword !== confirmPassword
            ) {
              var notification = document.createElement("div");
              notification.textContent =
                "Please correctly Enter Update Password Fiedls";
              notification.style.backgroundColor = "#F05F5E";
              notification.style.color = "white";
              notification.style.position = "fixed";
              notification.style.top = "0";
              notification.style.right = "0";
              notification.style.padding = "10px";
              notification.style.marginTop = "20px";
              notification.style.marginRight = "30px";
              notification.style.borderRadius = "5px";
              document.body.appendChild(notification);

              setTimeout(() => {
                document.body.removeChild(notification);
              }, 2000);
            } else {
              data = {
                currentEmail: currentEmail,
                currentPassword: currentPassword,
                updatePassword: newPassword,
              };

              fetch("http://localhost:3000/updatePassword", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
              })
                .then((response) => response.json())
                .then((data) => {
                  console.log("Response from server:", data.message);

                  if (data.message == "User password updated successfully.") {
                    var notification = document.createElement("div");
                    notification.textContent = data.message;
                    notification.style.backgroundColor = "#47C8A3";
                    notification.style.color = "white";
                    notification.style.position = "fixed";
                    notification.style.top = "0";
                    notification.style.right = "0";
                    notification.style.padding = "10px";
                    notification.style.marginTop = "20px";
                    notification.style.marginRight = "30px";
                    notification.style.borderRadius = "5px";
                    document.body.appendChild(notification);

                    setTimeout(() => {
                      document.body.removeChild(notification);
                    }, 2000);
                  } else {
                    var notification = document.createElement("div");
                    notification.textContent = data.message;
                    notification.style.backgroundColor = "#F05F5E";
                    notification.style.color = "white";
                    notification.style.position = "fixed";
                    notification.style.top = "0";
                    notification.style.right = "0";
                    notification.style.padding = "10px";
                    notification.style.marginTop = "20px";
                    notification.style.marginRight = "30px";
                    notification.style.borderRadius = "5px";
                    document.body.appendChild(notification);

                    setTimeout(() => {
                      document.body.removeChild(notification);
                    }, 2000);
                  }
                })
                .catch((error) => {
                  console.error("Error sending data to server:", error);
                });
            }
            event.preventDefault();
          }

          function savemyChanges() {
            fn = document.getElementById("first-name").value;
            ln = document.getElementById("last-name").value;

            fileInput = document.getElementById("input-file");
            file = fileInput.files[0];
            const reader = new FileReader();
                reader.onloadend = function () {
                      const base64String = reader.result.replace(/^data:image\/[A-Za-z]+;base64,/, '');
                      console.log(reader);
                      outsideScope(base64String)
                };

            cn = document.getElementById("comunity-name").value;
            pin = document.getElementById("zip-code").value;

            currentEmail = document.getElementById("current-email").value;

            if (file) {
                    reader.readAsDataURL(file);
                      function outsideScope(base64String) {

                        console.log(base64String);

                        const data = {
                          firstName: fn,
                          lastName: ln,
                          profileImage: base64String,
                          comunityName: cn,
                          zipCode: pin,
                          currentEmail: currentEmail
                        };

                        console.log(data);
                                    
                        fetch("http://localhost:3000/editDetails", {
                          method: "POST",
                          headers: {
                            "Content-Type": "application/json",
                          },
                          body: JSON.stringify(data),
                        })
                          .then((response) => response.json())
                          .then((data) => {
                            console.log("Response from server:", data.message);
                            console.log("Response from server:", data.image);

                            const finalImage = data.image
                            console.log(finalImage);

                            const imageElement = document.getElementById('get-image');
                            imageElement.src = `data:image/jpeg;base64,${finalImage}`;

                            var notification = document.createElement("div");
                            notification.textContent = data.message;
                            notification.style.backgroundColor = "#47C8A3";
                            notification.style.color = "white";
                            notification.style.position = "fixed";
                            notification.style.top = "0";
                            notification.style.right = "0";
                            notification.style.padding = "10px";
                            notification.style.marginTop = "20px";
                            notification.style.marginRight = "30px";
                            notification.style.borderRadius = "5px";
                            document.body.appendChild(notification);

                            setTimeout(() => {
                              document.body.removeChild(notification);
                              window.location.href =
                                "http://127.0.0.1:5500/themes/classimax-free/user-profile.html?get-image=#";
                            }, 2000);
                          })
                          .catch((error) => {
                            console.error("Error sending data to server:", error);
                          });
                      }
          }
          else {
                        const data = {
                          firstName: fn,
                          lastName: ln,
                          profileImage: "",
                          comunityName: cn,
                          zipCode: pin,
                          currentEmail: currentEmail
                        };

                        console.log(data);
                                    
                        fetch("http://localhost:3000/editDetails", {
                          method: "POST",
                          headers: {
                            "Content-Type": "application/json",
                          },
                          body: JSON.stringify(data),
                        })
                          .then((response) => response.json())
                          .then((data) => {
                            console.log("Response from server:", data.message);
                            console.log("Response from server:", data.image);

                            const finalImage = data.image
                            console.log(finalImage);

                            const imageElement = document.getElementById('get-image');
                            imageElement.src = `data:image/jpeg;base64,${finalImage}`;

                            var notification = document.createElement("div");
                            notification.textContent = data.message;
                            notification.style.backgroundColor = "#47C8A3";
                            notification.style.color = "white";
                            notification.style.position = "fixed";
                            notification.style.top = "0";
                            notification.style.right = "0";
                            notification.style.padding = "10px";
                            notification.style.marginTop = "20px";
                            notification.style.marginRight = "30px";
                            notification.style.borderRadius = "5px";
                            document.body.appendChild(notification);

                            setTimeout(() => {
                              document.body.removeChild(notification);
                              window.location.href =
                                "http://127.0.0.1:5500/themes/classimax-free/user-profile.html?get-image=#";
                            }, 2000);
                          })
                          .catch((error) => {
                            console.error("Error sending data to server:", error);
                          });
          }
          event.preventDefault();
          }

  

  </script>
</html>
